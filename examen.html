<!DOCTYPE html>
<html lang="en">

    <style>
        canvas{
            background-color: black;
        }
        body{
                background-color: white;
            }
    </style>

    <body>

        <center>
            <canvas width="700" height="500" id="myCanvas"></canvas>
        </center>

        <img src="minions_PNG54.png" id="mi_imagen" style="display: none;" alt="">

        <script>

                var canvas = document.getElementById('myCanvas');
                var ctx = canvas.getContext('2d');
                
                var img = new Image();
                img.src = "minions_PNG54.png";

                let x = 20;
                let y = 20;

                const velocidad = 5;
                

                window.requestAnimationFrame = (function () {
                    return window.requestAnimationFrame ||
                window.webkitRequestAnimationFrame ||
                window.mozRequestAnimationFrame ||
                    function (callback) {
                window.setTimeout(callback, 17);
                };

            }());

                // puntos
                // ctx.fillStyle = "yellow";
                // ctx.beginPath();
                // ctx.arc(101, 102, 2, 0, Math.PI * 2, true);
                // ctx.fill();

                // ctx.beginPath();
                // ctx.arc(89, 102, 2, 0, Math.PI * 2, true);
                // ctx.fill();

            function margen(ctx){
                    ctx.lineWidth = 5;
                    ctx.strokeStyle = "blue";

                    //margen
                    ctx.beginPath();
                    ctx.moveTo(5,5);
                    ctx.lineTo(5,495);
                    ctx.stroke();

                    ctx.beginPath();
                    ctx.moveTo(5,496);
                    ctx.lineTo(695,495);
                    ctx.stroke();

                    ctx.beginPath();
                    ctx.moveTo(696,496);
                    ctx.lineTo(696,5);
                    ctx.stroke();

                    ctx.beginPath();
                    ctx.moveTo(695,5);
                    ctx.lineTo(5,5);
                    ctx.stroke();

                    ctx.lineWidth = 2.5;

                    drawRoundedRectangles(ctx, rectangles);
                } 

                function drawRoundedRectangles(ctx, rectangles) {
                    
                    rectangles.forEach(function(rect) {
                        ctx.beginPath();
                        roundedRect(ctx, rect.x, rect.y, rect.width, rect.height, rect.radius);
                        ctx.stroke();
                        ctx.closePath();
                    });
            }

            var rectangles = [
                { x: 260, y: 60, width: 170, height: 15, radius: 10 },
                { x: 260, y: 435, width: 170, height: 15, radius: 10 },
                { x: 165, y: 130, width: 59, height: 20, radius: 10 },
                { x: 470, y: 130, width: 59, height: 20, radius: 10 },
                { x: 165, y: 330, width: 59, height: 20, radius: 10 },
                { x: 470, y: 330, width: 59, height: 20, radius: 10 },
                { x: 270, y: 150, width: 160, height: 200, radius: 10 },
                //{ x: 15,  y: 15, width: 670, height: 470,radius: 0},
                { x: 190, y: 15, width: 25, height: 60,radius: 0},
                { x: 471, y: 15, width: 25, height: 60,radius: 0},
                { x: 190, y: 423, width: 25, height: 60,radius: 0},
                { x: 471, y: 423, width: 25, height: 60,radius: 0},
                //L
                { x: 60, y: 95, width: 25, height: 60,radius: 0},
                { x: 60, y: 73, width: 60, height: 20,radius: 0},
                { x: 60, y: 360, width: 25, height: 60,radius: 0},
                { x: 60, y: 423, width: 60, height: 20,radius: 0},
                //
                { x: 640, y: 95, width: 25, height: 60,radius: 0},
                { x: 606, y: 73, width: 60, height: 20,radius: 0},
                { x: 640, y: 360, width: 25, height: 60,radius: 0},
                { x: 606, y: 423, width: 60, height: 20,radius: 0},

            ];


            function roundedRect(ctx, x, y, width, height, radius) {
                ctx.beginPath();
                ctx.moveTo(x, y + radius);
                ctx.arcTo(x, y + height, x + radius, y + height, radius);
                ctx.arcTo(x + width, y + height, x + width, y + height - radius, radius);
                ctx.arcTo(x + width, y, x + width - radius, y, radius);
                ctx.arcTo(x, y, x, y + radius, radius);
                ctx.stroke();
            }

    
            function drawImg() {
                for (var i = 0; i < rectangles.length; i++) {
                    if (Collide({ x: x, y: y, width: 35, height: 35 }, rectangles[i])) {
                        console.log("ColisiÃ³n ");
                        return;
                        
                    }
                }

                ctx.clearRect(x, y, 35, 35);
                ctx.drawImage(img, x, y, 35, 35);
            
                requestAnimationFrame(drawImg);
            }


            img.onload = function () {
                drawImg();
            };

            document.addEventListener("keydown", function (e) {
                switch(e.keyCode){
                        case 87:
                            y -=velocidad;
                        break;

                        case 83:
                            y +=velocidad;
                        break;

                        case 68:
                            x +=velocidad;
                        break;

                        case 65:

                            x -=velocidad;
                        break;
                    }
            });

            margen(ctx);

            function Collide(rect1, rect2) {
                return (
                    rect1.x < rect2.x + rect2.width &&
                    rect1.x + 35 > rect2.x &&
                    rect1.y < rect2.y + rect2.height &&
                    rect1.y + 35 > rect2.y
                );
            }

        </script>

    </body>

</html>